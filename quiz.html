<script>
  let usedWords = [];
  let wordPool = [];

  function fetchWordsFromSheet() {
    const sheetUrl = "https://docs.google.com/spreadsheets/d/1pH548uz07eio47oxgPMPjq7zAWOuls2eihG9D2E0HvU/export?format=csv&gid=0";
    fetch(sheetUrl)
      .then(response => response.text())
      .then(csv => {
        const rows = csv.split("\n");
        wordPool = rows.map(row => row.trim()).filter(word => word); // 空行を除外
      });
  }

  function showNextWord() {
    if (usedWords.length >= 100) {
      usedWords = [];
    }

    const availableWords = wordPool.filter(word => !usedWords.includes(word));
    if (availableWords.length === 0) {
      document.getElementById("wordDisplay").textContent = "すべて出題済み！";
      return;
    }

    const nextWord = availableWords[Math.floor(Math.random() * availableWords.length)];
    usedWords.push(nextWord);
    document.getElementById("wordDisplay").textContent = nextWord;
  }

  window.onload = fetchWordsFromSheet;
</script>
